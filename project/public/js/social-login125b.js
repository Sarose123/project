jQuery(function($){var tab=location.hash;var SocialLogin={loginInit:function(id){if(is(name)&&is(id)){return new Promise(function(rej){$.post('/wp-admin/admin-ajax.php/',{action:'user_social_login',id:id},function(res){rej(res);});});}return new Promise();},signupUser:function(user){if(is(user)){return new Promise(function(rej){user=JSON.stringify(user);$.post('/wp-admin/admin-ajax.php/',{action:'user_signup',user:user},function(res){rej(res);});});}return new Promise();},linkUser:function(id,uid,soc){if(is(id)&&is(uid)&&is(soc)){return new Promise(function(rej){$.post('/wp-admin/admin-ajax.php/',{action:'user_social_link',id:id,uid:uid,soc:soc},function(res){rej(res);});});}return new Promise();}};if(tab=='#liogin'){$('.services form').removeClass('form-active');$('.log-in-form').addClass('form-active');}if(tab=='#signup'){$('.services form').removeClass('form-active');$('.sign-up-form').addClass('form-active');}$('#log-in-form').on('submit',function(e){e.preventDefault();var form=this;$.post('/wp-admin/admin-ajax.php',{action:'user_login',login:this.login.value,pass:this.pass.value},function(res){res=JSON.parse(res);if(res.status=='logined'){location.href='/my-account/';}else if(res.status=='error'){form.loginbutton.value='Wrong pass or login';if(typeof loginmsgtimer!='undefined')clearTimeout(loginmsgtimer);window.loginmsgtimer=setTimeout(function(){form.loginbutton.value='Submit';},3000);}else{}});});$('#woo-sign-up').on('submit',function(e){e.preventDefault();var form=this;var check=!checkfield(form.username,{len:3})||!checkfield(form.password,{len:3})||!checkfield(form['re-password'],{len:3})||form.password.value!=form['re-password'].value;if(check)return;var name=form.username.value.split(' ');var redirect=typeof form.redirect!="undefined"?form.redirect.value:'';SocialLogin.signupUser({user:{user_login:form.username.value,user_pass:form.password.value,display_name:form.username.value,first_name:name[0],last_name:is(name[1])?name[1]:''},meta:{billing_first_name:name[0],billing_last_name:is(name[1])?name[1]:''}}).then(function(resps){resps=JSON.parse(resps);if(resps.status=="error"){swal('Ooops...',resps.message,'error');return;}$.post('/wp-admin/admin-ajax.php',{action:'user_login',login:form.username.value,pass:form.password.value},function(res){res=JSON.parse(res);if(res.status=='logined'){location.href=typeof redirect!='undefined'&&redirect!=''?redirect:'/my-account/edit-address/billing/?complete=1';}else{$(form).find('.up-submit').val('Error while login');location.reload();}});});});var passFi=false;if(is(PassField))passFi=new PassField.Field("up-password");$('#sign-up-form').on('submit',function(e){e.preventDefault();var form=this;var erro=[];var pass=!checkfield(form.pass,{len:3,eq:form.repass});var repas=!checkfield(form.repass,{len:3,eq:form.pass});if(pass)erro.push('The password is weak or not contain repet pasword field');if(repas)erro.push('The repetpassword not contain pasword field');console.log(passFi);if(!passFi.validatePass())erro.push('The password is weak, it must contain a minimum of 8 characters. 1 numeric character, 1 upper case letter, 1 lower case letter');if(!checkfield(form.fname,{len:3}))erro.push('Name field is too short it must contain min 3 characters');if(!checkfield(form.lname,{len:3}))erro.push('Last Name field is too short it must contain min 3 characters');if(!checkfield(form.mail,{len:3}))erro.push('Mail field is too short it must contain min 5 characters and have @,. sumbols');if(!checkfield(form.country,{len:2}))erro.push('Please select country');if(erro.length>0){var msg='<ul class="error-hold">';erro.forEach(function(el){msg+='<li class="error-row">'+el+'</li>';});msg+='</ul>';swal({title:"Oops...",text:msg,type:"error",html:true});return;}var redirect=typeof form.redirect!="undefined"?form.redirect.value:'';SocialLogin.signupUser({user:{user_login:form.mail.value,user_pass:form.pass.value,display_name:form.fname.value+' '+form.lname.value,first_name:form.fname.value,last_name:form.lname.value,user_email:form.mail.value,},meta:{shipping_country:form.country.value,billing_country:form.country.value,billing_first_name:form.fname.value,billing_last_name:form.lname.value,billing_email:form.mail.value,account_email:form.mail.value}}).then(function(resps){resps=JSON.parse(resps);if(resps.status=="error"){swal('Ooops...',resps.message,'error');return;}$.post('/wp-admin/admin-ajax.php',{action:'user_login',login:form.mail.value,pass:form.pass.value},function(res){res=JSON.parse(res);if(res.status=='logined'){location.href=typeof redirect!='undefined'&&redirect!=''?redirect:'/my-account/edit-address/billing/?complete=1';}else{$(form).find('.up-submit').val('Error while login');location.reload();}});});});$('.gplus-button').click(function(){var redirect=typeof this.dataset.redirect!='undefined'?this.dataset.redirect:'';Go.onSignIn=function(){Go.getUserData().then(function(respp){SocialLogin.loginInit('go_'+respp.id).then(function(res){res=JSON.parse(res);if(res.status=='error'){swal({title:'<i>Login</i> <u>Error</u>',type:'error',text:res.message,html:true,showCloseButton:true,});}if(res.status=='logined'){location.href=typeof redirect!='undefined'&&redirect!=''?redirect:'/my-account';}if(res.status=='no user'){var name=respp.displayName.split(" ");console.log(respp);var mail=Array.isArray(respp.emails)&&respp.emails.length>0&&typeof respp.emails[0].value!='undefined'?respp.emails[0].value:'';SocialLogin.signupUser({user:{user_login:'go_'+respp.id,user_pass:'go_'+respp.id+respp.displayName,display_name:respp.displayName,first_name:name[0],last_name:is(name[1])?name[1]:'',user_email:mail,},meta:{go_id:'go_'+respp.id,billing_first_name:name[0],billing_last_name:is(name[1])?name[1]:'',shipping_city:'',shipping_country:'none',shipping_state:'',shipping_address_1:'',billing_city:'',billing_country:'none',billing_state:'',billing_address_1:'',billing_email:mail,}}).then(function(resp){resp=JSON.parse(resp);if(resp.status=='error'){swal('Ooops...',resp.message,'error');}SocialLogin.loginInit('go_'+respp.id).then(function(res){res=JSON.parse(res);if(res.status=='logined'){location.href=typeof redirect!='undefined'&&redirect!=''?redirect:'/my-account/edit-address/billing/?complete=1';}else{console.log(res);}});});}});});};Go.signIn();});$('.fb-button').click(function(){var redirect=typeof this.dataset.redirect!='undefined'?this.dataset.redirect:'';FB.login(function(response){if(response.status=='connected'){SocialLogin.loginInit(response.authResponse.userID).then(function(res){res=JSON.parse(res);if(res.status=='error'){swal({title:'<i>Login</i> <u>Error</u>',type:'error',text:res.message,html:true,showCloseButton:true,});}if(res.status=='logined'){location.href=typeof redirect!='undefined'&&redirect!=''?redirect:'/my-account';}if(res.status=='no user'){FB.api('/me?fields=id,name,location,hometown,picture,email',function(e){var city=is(e.location)&&is(e.location.name)?e.location.name:',';city=city.split(',');city[1]=typeof city[1]!='undefined'&&city[1]!=''?city[1]:'none';var name=e.name.split(" ");var mail=typeof e.email!='undefied'?e.email:'';SocialLogin.signupUser({user:{user_login:e.id,user_pass:e.id+e.name,display_name:e.name,first_name:name[0],last_name:is(name[1])?name[1]:'',user_email:mail,},meta:{fb_id:e.id,shipping_city:city[0],shipping_country:city[1],shipping_state:'',shipping_address_1:'',billing_city:city[0],billing_country:city[1],billing_state:'',billing_address_1:'',billing_first_name:name[0],billing_last_name:is(name[1])?name[1]:'',billing_email:mail}}).then(function(resp){resp=JSON.parse(resp);if(resp.status=='error'){swal('Ooops...',resp.message,'error');}SocialLogin.loginInit(response.authResponse.userID).then(function(res){res=JSON.parse(res);if(res.status=='logined'){location.href=typeof redirect!='undefined'&&redirect!=''?redirect:'/my-account/edit-address/billing/?complete=1';}else{console.log(res);}});});});}});}},{scope:'email,user_birthday,user_location,user_hometown'});});function is(a){return typeof a!='undfined'&&a!=null;}function checkfield(el,p){if(is(el)&&is(p)){var pass=true;if(is(p.len)&&el.value.length<p.len)pass=false;if(is(p.eq)&&is(p.eq.value)&&p.eq.value!==el.value)pass=false;if(!pass){var cl=el.classList;if(is(cl))el.classList.add('error');if(is(p.eq)&&is(p.eq.value))p.eq.classList.add('error');el.onkeyup=function(){checkfield(this,p);}}else{el.classList.remove('error');if(is(p.eq)&&is(p.eq.value))p.eq.classList.remove('error');}return pass;}return false;}});setTimeout(function(){window.fbAsyncInit=function(){FB.init({appId:'363769104059920',cookie:true,xfbml:true,version:'v2.8'});FB.AppEvents.logPageView();};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return;}js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_US/sdk.js";fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));},5000);var Go={is_init:false,script_url:'https://plus.google.com/js/client:platform.js',apiKey:'AIzaSyCn_3Mh7GuN8xY0uI-Uv7_VxaDgscAtDps',clientId:"302794390174-uli66lg9ukv2a4dqvbiacuc19senrijh.apps.googleusercontent.com",maxContacts:50,init:function(){var s=document.createElement('script');s.async=true;s.defer=true;s.onload=function(){this.onload=function(){};Go.LoadClient();};s.onreadystatechange=function(){if(this.readyState==='complete')this.onload()};s.src=this.script_url;document.getElementsByTagName('body')[0].appendChild(s);this.is_init=true;},LoadClient:function(){gapi.load('client:auth2',function(){gapi.client.load('plus');setTimeout(function(){gapi.client.init({apiKey:Go.apiKey,discoveryDocs:["https://people.googleapis.com/$discovery/rest?version=v1"],clientId:Go.clientId,scope:'https://www.googleapis.com/auth/plus.me https://www.googleapis.com/auth/plus.login'}).then(function(){gapi.auth2.getAuthInstance().isSignedIn.listen(Go.onSignIn);Go.onSignIn(gapi.auth2.getAuthInstance().isSignedIn.get());Go.onInit(gapi.auth2.getAuthInstance().isSignedIn.get());});},2000);});},onSignIn:function(isSign){},onInit:function(isSign){},signIn:function(){if(this.is_init){gapi.auth2.getAuthInstance().signIn();}else{this.onInit=function(isSign){if(!isSign){Go.signIn();}};this.init();}},getUserFrends:function(){return new Promise(function(rej){gapi.client.plus.people.list({'userId':'me','collection':'visible'}).execute(function(resp){rej(resp);});});},getUserData:function(){return new Promise(function(rej){gapi.client.plus.people.get({'userId':'me'}).execute(function(resp){rej(resp);});});}};